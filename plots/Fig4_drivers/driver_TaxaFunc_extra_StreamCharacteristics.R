##Set working directory
setwd("C:/Users/elwel/OneDrive/Desktop/aquatic_data/git/EuroAquaticMacroInverts")

# attach data
#drivEst <- read.csv("outputs/Driver_metaanaly_Ests.csv")
drivEst <- read.csv("outputs/outputs_driver/Driver_horseshoe_metaanaly_Ests.csv")
head(drivEst)
unique(drivEst$Response)

options(scipen=999)

##save plot
#tiff(filename = "plots/Fig4_drivers/Drivers_TaxaFunc_extra_streamCharacteristics.tiff", width = 5, height = 4, units = 'in', res = 600, compression = 'lzw')
tiff(filename = "plots/Fig4_drivers/Drivers_TaxaFunc_extra_streamCharacteristics_horseshoe.tiff", width = 5, height = 5, units = 'in', res = 600, compression = 'lzw')

##layout
layout(mat = matrix(c(1:6), 
                        nrow = 2, 
                        ncol = 3),
       heights = c(2,2,2,2,2,2),
       widths = c(0.8,2,2,0.8,2,2))

par(mar=c(4,0.4,0.4,0.8))
#empty plot for where the labels will go
plot(0, xaxt = 'n', yaxt = 'n', bty = 'n', pch = '', ylab = '', xlab = '')
plot(0, xaxt = 'n', yaxt = 'n', bty = 'n', pch = '', ylab = '', xlab = '')

#### shannonsH #####
sub <- subset(drivEst, Response == "shannonsH")
subQ <- c(sub$Q0.5[6:9],sub$Q95[6:9])
est <- sub$Estimate[6:9]
yy <- c(1:4)
plot(yy ~ est, ylab="",xlab="", yaxt="n", las=1, type="n",xlim=c(min(subQ),max(subQ)), ylim=c(0.8,4.8),cex=2, bty="n")
#polygon(x=c(-100,-100,0,0),
#        y=c(-4,22,22,-4), col = "grey80", border = "grey80")
segments(x0=0,y0=0,x1=0,y1=4.18,lty=2, lwd=2,col="grey60")
axis(2, at=yy, lwd = 0, lwd.ticks = 0, labels=c("str. order", "accum.", "elevation", "slope"), las=1,cex.axis=1.3)
title(xlab="Estimate", line=2.4,cex.lab=1.3)
legend("topleft", legend=("a, Shannon's H"), bty="n", cex=1.3)
mm <- cbind(yy,est)
mm_neg <- as.data.frame(mm[ which(est < 0),])
mm_pos <- as.data.frame(mm[ which(est > 0),])
#points(yy ~ est, pch="l",cex=2.2,col="white")
points(mm_neg$yy ~ mm_neg$est, pch="l",cex=4,col="firebrick2")
points(mm_pos[1,] ~ mm_pos[2,], pch="l",cex=4,col="dodgerblue")
yyy1=c(0.975,1.025,1.025,0.975)
yyy2=c(0.95,1.05,1.05,0.95)
yyy3=c(0.9,1.1,1.1,0.9)
polygon(x=c(if (sub$Q2.5[6]<0) {sub$Q2.5[6]} else {0}, if (sub$Q2.5[6]<0) {sub$Q2.5[6]} else {0}, if (sub$Q97.5[6]<0) {sub$Q97.5[6]} else {0}, if (sub$Q97.5[6]<0) {sub$Q97.5[6]} else {0}),y=(yyy1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[6]<0) {sub$Q5[6]} else {0}, if (sub$Q5[6]<0) {sub$Q5[6]} else {0}, if (sub$Q95[6]<0) {sub$Q95[6]} else {0}, if (sub$Q95[6]<0) {sub$Q95[6]} else {0}),y=(yyy2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[6]<0) {sub$Q10[6]} else {0}, if (sub$Q10[6]<0) {sub$Q10[6]} else {0}, if (sub$Q90[6]<0) {sub$Q90[6]} else {0}, if (sub$Q90[6]<0) {sub$Q90[6]} else {0}),y=(yyy3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[6]>0) {sub$Q2.5[6]} else {0}, if (sub$Q2.5[6]>0) {sub$Q2.5[6]} else {0}, if (sub$Q97.5[6]>0) {sub$Q97.5[6]} else {0}, if (sub$Q97.5[6]>0) {sub$Q97.5[6]} else {0}),y=(yyy1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[6]>0) {sub$Q5[6]} else {0}, if (sub$Q5[6]>0) {sub$Q5[6]} else {0}, if (sub$Q95[6]>0) {sub$Q95[6]} else {0}, if (sub$Q95[6]>0) {sub$Q95[6]} else {0}),y=(yyy2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[6]>0) {sub$Q10[6]} else {0}, if (sub$Q10[6]>0) {sub$Q10[6]} else {0}, if (sub$Q90[6]>0) {sub$Q90[6]} else {0}, if (sub$Q90[6]>0) {sub$Q90[6]} else {0}),y=(yyy3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[7]<0) {sub$Q2.5[7]} else {0}, if (sub$Q2.5[7]<0) {sub$Q2.5[7]} else {0}, if (sub$Q97.5[7]<0) {sub$Q97.5[7]} else {0}, if (sub$Q97.5[7]<0) {sub$Q97.5[7]} else {0}),y=(yyy1+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[7]<0) {sub$Q5[7]} else {0}, if (sub$Q5[7]<0) {sub$Q5[7]} else {0}, if (sub$Q95[7]<0) {sub$Q95[7]} else {0}, if (sub$Q95[7]<0) {sub$Q95[7]} else {0}),y=(yyy2+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[7]<0) {sub$Q10[7]} else {0}, if (sub$Q10[7]<0) {sub$Q10[7]} else {0}, if (sub$Q90[7]<0) {sub$Q90[7]} else {0}, if (sub$Q90[7]<0) {sub$Q90[7]} else {0}),y=(yyy3+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[7]>0) {sub$Q2.5[7]} else {0}, if (sub$Q2.5[7]>0) {sub$Q2.5[7]} else {0}, if (sub$Q97.5[7]>0) {sub$Q97.5[7]} else {0}, if (sub$Q97.5[7]>0) {sub$Q97.5[7]} else {0}),y=(yyy1+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[7]>0) {sub$Q5[7]} else {0}, if (sub$Q5[7]>0) {sub$Q5[7]} else {0}, if (sub$Q95[7]>0) {sub$Q95[7]} else {0}, if (sub$Q95[7]>0) {sub$Q95[7]} else {0}),y=(yyy2+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[7]>0) {sub$Q10[7]} else {0}, if (sub$Q10[7]>0) {sub$Q10[7]} else {0}, if (sub$Q90[7]>0) {sub$Q90[7]} else {0}, if (sub$Q90[7]>0) {sub$Q90[7]} else {0}),y=(yyy3+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[8]<0) {sub$Q2.5[8]} else {0}, if (sub$Q2.5[8]<0) {sub$Q2.5[8]} else {0}, if (sub$Q97.5[8]<0) {sub$Q97.5[8]} else {0}, if (sub$Q97.5[8]<0) {sub$Q97.5[8]} else {0}),y=(yyy1+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[8]<0) {sub$Q5[8]} else {0}, if (sub$Q5[8]<0) {sub$Q5[8]} else {0}, if (sub$Q95[8]<0) {sub$Q95[8]} else {0}, if (sub$Q95[8]<0) {sub$Q95[8]} else {0}),y=(yyy2+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[8]<0) {sub$Q10[8]} else {0}, if (sub$Q10[8]<0) {sub$Q10[8]} else {0}, if (sub$Q90[8]<0) {sub$Q90[8]} else {0}, if (sub$Q90[8]<0) {sub$Q90[8]} else {0}),y=(yyy3+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[8]>0) {sub$Q2.5[8]} else {0}, if (sub$Q2.5[8]>0) {sub$Q2.5[8]} else {0}, if (sub$Q97.5[8]>0) {sub$Q97.5[8]} else {0}, if (sub$Q97.5[8]>0) {sub$Q97.5[8]} else {0}),y=(yyy1+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[8]>0) {sub$Q5[8]} else {0}, if (sub$Q5[8]>0) {sub$Q5[8]} else {0}, if (sub$Q95[8]>0) {sub$Q95[8]} else {0}, if (sub$Q95[8]>0) {sub$Q95[8]} else {0}),y=(yyy2+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[8]>0) {sub$Q10[8]} else {0}, if (sub$Q10[8]>0) {sub$Q10[8]} else {0}, if (sub$Q90[8]>0) {sub$Q90[8]} else {0}, if (sub$Q90[8]>0) {sub$Q90[8]} else {0}),y=(yyy3+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[9]<0) {sub$Q2.5[9]} else {0}, if (sub$Q2.5[9]<0) {sub$Q2.5[9]} else {0}, if (sub$Q97.5[9]<0) {sub$Q97.5[9]} else {0}, if (sub$Q97.5[9]<0) {sub$Q97.5[9]} else {0}),y=(yyy1+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[9]<0) {sub$Q5[9]} else {0}, if (sub$Q5[9]<0) {sub$Q5[9]} else {0}, if (sub$Q95[9]<0) {sub$Q95[9]} else {0}, if (sub$Q95[9]<0) {sub$Q95[9]} else {0}),y=(yyy2+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[9]<0) {sub$Q10[9]} else {0}, if (sub$Q10[9]<0) {sub$Q10[9]} else {0}, if (sub$Q90[9]<0) {sub$Q90[9]} else {0}, if (sub$Q90[9]<0) {sub$Q90[9]} else {0}),y=(yyy3+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[9]>0) {sub$Q2.5[9]} else {0}, if (sub$Q2.5[9]>0) {sub$Q2.5[9]} else {0}, if (sub$Q97.5[9]>0) {sub$Q97.5[9]} else {0}, if (sub$Q97.5[9]>0) {sub$Q97.5[9]} else {0}),y=(yyy1+3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[9]>0) {sub$Q5[9]} else {0}, if (sub$Q5[9]>0) {sub$Q5[9]} else {0}, if (sub$Q95[9]>0) {sub$Q95[9]} else {0}, if (sub$Q95[9]>0) {sub$Q95[9]} else {0}),y=(yyy2+3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[9]>0) {sub$Q10[9]} else {0}, if (sub$Q10[9]>0) {sub$Q10[9]} else {0}, if (sub$Q90[9]>0) {sub$Q90[9]} else {0}, if (sub$Q90[9]>0) {sub$Q90[9]} else {0}),y=(yyy3+3), col = "dodgerblue", border = NA)

#### func_diverg #####
sub <- subset(drivEst, Response == "func_diverg")
subQ <- c(sub$Q0.5[6:9],sub$Q95[6:9])
est <- sub$Estimate[6:9]
yy <- c(1:4)
plot(yy ~ est, ylab="",xlab="", yaxt="n", las=1, type="n",xlim=c(min(subQ),max(subQ)), ylim=c(0.8,4.8),cex=2, bty="n")
segments(x0=0,y0=0,x1=0,y1=4.18,lty=2, lwd=2,col="grey60")
axis(2, at=yy, lwd = 0, lwd.ticks = 0, labels=c("str. order", "accum.", "elevation", "slope"), las=1,cex.axis=1.3)
title(xlab="Estimate", line=2.4,cex.lab=1.3)
legend("topleft", legend=("c, Func. divergence"), bty="n", cex=1.3)
mm <- cbind(yy,est)
mm_neg <- as.data.frame(mm[ which(est < 0),])
mm_pos <- as.data.frame(mm[ which(est > 0),])
points(mm_neg$yy ~ mm_neg$est, pch="l",cex=4,col="firebrick2")
points(mm_pos[1,] ~ mm_pos[2,], pch="l",cex=4,col="dodgerblue")
yyy1=c(0.975,1.025,1.025,0.975)
yyy2=c(0.95,1.05,1.05,0.95)
yyy3=c(0.9,1.1,1.1,0.9)
polygon(x=c(if (sub$Q2.5[6]<0) {sub$Q2.5[6]} else {0}, if (sub$Q2.5[6]<0) {sub$Q2.5[6]} else {0}, if (sub$Q97.5[6]<0) {sub$Q97.5[6]} else {0}, if (sub$Q97.5[6]<0) {sub$Q97.5[6]} else {0}),y=(yyy1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[6]<0) {sub$Q5[6]} else {0}, if (sub$Q5[6]<0) {sub$Q5[6]} else {0}, if (sub$Q95[6]<0) {sub$Q95[6]} else {0}, if (sub$Q95[6]<0) {sub$Q95[6]} else {0}),y=(yyy2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[6]<0) {sub$Q10[6]} else {0}, if (sub$Q10[6]<0) {sub$Q10[6]} else {0}, if (sub$Q90[6]<0) {sub$Q90[6]} else {0}, if (sub$Q90[6]<0) {sub$Q90[6]} else {0}),y=(yyy3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[6]>0) {sub$Q2.5[6]} else {0}, if (sub$Q2.5[6]>0) {sub$Q2.5[6]} else {0}, if (sub$Q97.5[6]>0) {sub$Q97.5[6]} else {0}, if (sub$Q97.5[6]>0) {sub$Q97.5[6]} else {0}),y=(yyy1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[6]>0) {sub$Q5[6]} else {0}, if (sub$Q5[6]>0) {sub$Q5[6]} else {0}, if (sub$Q95[6]>0) {sub$Q95[6]} else {0}, if (sub$Q95[6]>0) {sub$Q95[6]} else {0}),y=(yyy2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[6]>0) {sub$Q10[6]} else {0}, if (sub$Q10[6]>0) {sub$Q10[6]} else {0}, if (sub$Q90[6]>0) {sub$Q90[6]} else {0}, if (sub$Q90[6]>0) {sub$Q90[6]} else {0}),y=(yyy3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[7]<0) {sub$Q2.5[7]} else {0}, if (sub$Q2.5[7]<0) {sub$Q2.5[7]} else {0}, if (sub$Q97.5[7]<0) {sub$Q97.5[7]} else {0}, if (sub$Q97.5[7]<0) {sub$Q97.5[7]} else {0}),y=(yyy1+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[7]<0) {sub$Q5[7]} else {0}, if (sub$Q5[7]<0) {sub$Q5[7]} else {0}, if (sub$Q95[7]<0) {sub$Q95[7]} else {0}, if (sub$Q95[7]<0) {sub$Q95[7]} else {0}),y=(yyy2+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[7]<0) {sub$Q10[7]} else {0}, if (sub$Q10[7]<0) {sub$Q10[7]} else {0}, if (sub$Q90[7]<0) {sub$Q90[7]} else {0}, if (sub$Q90[7]<0) {sub$Q90[7]} else {0}),y=(yyy3+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[7]>0) {sub$Q2.5[7]} else {0}, if (sub$Q2.5[7]>0) {sub$Q2.5[7]} else {0}, if (sub$Q97.5[7]>0) {sub$Q97.5[7]} else {0}, if (sub$Q97.5[7]>0) {sub$Q97.5[7]} else {0}),y=(yyy1+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[7]>0) {sub$Q5[7]} else {0}, if (sub$Q5[7]>0) {sub$Q5[7]} else {0}, if (sub$Q95[7]>0) {sub$Q95[7]} else {0}, if (sub$Q95[7]>0) {sub$Q95[7]} else {0}),y=(yyy2+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[7]>0) {sub$Q10[7]} else {0}, if (sub$Q10[7]>0) {sub$Q10[7]} else {0}, if (sub$Q90[7]>0) {sub$Q90[7]} else {0}, if (sub$Q90[7]>0) {sub$Q90[7]} else {0}),y=(yyy3+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[8]<0) {sub$Q2.5[8]} else {0}, if (sub$Q2.5[8]<0) {sub$Q2.5[8]} else {0}, if (sub$Q97.5[8]<0) {sub$Q97.5[8]} else {0}, if (sub$Q97.5[8]<0) {sub$Q97.5[8]} else {0}),y=(yyy1+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[8]<0) {sub$Q5[8]} else {0}, if (sub$Q5[8]<0) {sub$Q5[8]} else {0}, if (sub$Q95[8]<0) {sub$Q95[8]} else {0}, if (sub$Q95[8]<0) {sub$Q95[8]} else {0}),y=(yyy2+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[8]<0) {sub$Q10[8]} else {0}, if (sub$Q10[8]<0) {sub$Q10[8]} else {0}, if (sub$Q90[8]<0) {sub$Q90[8]} else {0}, if (sub$Q90[8]<0) {sub$Q90[8]} else {0}),y=(yyy3+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[8]>0) {sub$Q2.5[8]} else {0}, if (sub$Q2.5[8]>0) {sub$Q2.5[8]} else {0}, if (sub$Q97.5[8]>0) {sub$Q97.5[8]} else {0}, if (sub$Q97.5[8]>0) {sub$Q97.5[8]} else {0}),y=(yyy1+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[8]>0) {sub$Q5[8]} else {0}, if (sub$Q5[8]>0) {sub$Q5[8]} else {0}, if (sub$Q95[8]>0) {sub$Q95[8]} else {0}, if (sub$Q95[8]>0) {sub$Q95[8]} else {0}),y=(yyy2+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[8]>0) {sub$Q10[8]} else {0}, if (sub$Q10[8]>0) {sub$Q10[8]} else {0}, if (sub$Q90[8]>0) {sub$Q90[8]} else {0}, if (sub$Q90[8]>0) {sub$Q90[8]} else {0}),y=(yyy3+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[9]<0) {sub$Q2.5[9]} else {0}, if (sub$Q2.5[9]<0) {sub$Q2.5[9]} else {0}, if (sub$Q97.5[9]<0) {sub$Q97.5[9]} else {0}, if (sub$Q97.5[9]<0) {sub$Q97.5[9]} else {0}),y=(yyy1+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[9]<0) {sub$Q5[9]} else {0}, if (sub$Q5[9]<0) {sub$Q5[9]} else {0}, if (sub$Q95[9]<0) {sub$Q95[9]} else {0}, if (sub$Q95[9]<0) {sub$Q95[9]} else {0}),y=(yyy2+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[9]<0) {sub$Q10[9]} else {0}, if (sub$Q10[9]<0) {sub$Q10[9]} else {0}, if (sub$Q90[9]<0) {sub$Q90[9]} else {0}, if (sub$Q90[9]<0) {sub$Q90[9]} else {0}),y=(yyy3+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[9]>0) {sub$Q2.5[9]} else {0}, if (sub$Q2.5[9]>0) {sub$Q2.5[9]} else {0}, if (sub$Q97.5[9]>0) {sub$Q97.5[9]} else {0}, if (sub$Q97.5[9]>0) {sub$Q97.5[9]} else {0}),y=(yyy1+3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[9]>0) {sub$Q5[9]} else {0}, if (sub$Q5[9]>0) {sub$Q5[9]} else {0}, if (sub$Q95[9]>0) {sub$Q95[9]} else {0}, if (sub$Q95[9]>0) {sub$Q95[9]} else {0}),y=(yyy2+3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[9]>0) {sub$Q10[9]} else {0}, if (sub$Q10[9]>0) {sub$Q10[9]} else {0}, if (sub$Q90[9]>0) {sub$Q90[9]} else {0}, if (sub$Q90[9]>0) {sub$Q90[9]} else {0}),y=(yyy3+3), col = "dodgerblue", border = NA)

#### spp_richness_rarefied #####
sub <- subset(drivEst, Response == "spp_richness_rarefied")
subQ <- c(sub$Q0.5[6:9],sub$Q95[6:9])
est <- sub$Estimate[6:9]
yy <- c(1:4)
plot(yy ~ est, ylab="",xlab="", yaxt="n", las=1, type="n",xlim=c(min(subQ),max(subQ)), ylim=c(0.8,4.8),cex=2, bty="n")
segments(x0=0,y0=0,x1=0,y1=4.18,lty=2, lwd=2,col="grey60")
title(xlab="Estimate", line=2.4,cex.lab=1.3)
legend("topleft", legend=("b, Rarefied richness"), bty="n", cex=1.3)
mm <- cbind(yy,est)
mm_neg <- as.data.frame(mm[ which(est < 0),])
mm_pos <- as.data.frame(mm[ which(est > 0),])
#points(yy ~ est, pch="l",cex=2.2,col="white")
points(mm_neg$yy ~ mm_neg$est, pch="l",cex=4,col="firebrick2")
points(mm_pos[1,] ~ mm_pos[2,], pch="l",cex=4,col="dodgerblue")
polygon(x=c(if (sub$Q2.5[6]<0) {sub$Q2.5[6]} else {0}, if (sub$Q2.5[6]<0) {sub$Q2.5[6]} else {0}, if (sub$Q97.5[6]<0) {sub$Q97.5[6]} else {0}, if (sub$Q97.5[6]<0) {sub$Q97.5[6]} else {0}),y=(yyy1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[6]<0) {sub$Q5[6]} else {0}, if (sub$Q5[6]<0) {sub$Q5[6]} else {0}, if (sub$Q95[6]<0) {sub$Q95[6]} else {0}, if (sub$Q95[6]<0) {sub$Q95[6]} else {0}),y=(yyy2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[6]<0) {sub$Q10[6]} else {0}, if (sub$Q10[6]<0) {sub$Q10[6]} else {0}, if (sub$Q90[6]<0) {sub$Q90[6]} else {0}, if (sub$Q90[6]<0) {sub$Q90[6]} else {0}),y=(yyy3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[6]>0) {sub$Q2.5[6]} else {0}, if (sub$Q2.5[6]>0) {sub$Q2.5[6]} else {0}, if (sub$Q97.5[6]>0) {sub$Q97.5[6]} else {0}, if (sub$Q97.5[6]>0) {sub$Q97.5[6]} else {0}),y=(yyy1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[6]>0) {sub$Q5[6]} else {0}, if (sub$Q5[6]>0) {sub$Q5[6]} else {0}, if (sub$Q95[6]>0) {sub$Q95[6]} else {0}, if (sub$Q95[6]>0) {sub$Q95[6]} else {0}),y=(yyy2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[6]>0) {sub$Q10[6]} else {0}, if (sub$Q10[6]>0) {sub$Q10[6]} else {0}, if (sub$Q90[6]>0) {sub$Q90[6]} else {0}, if (sub$Q90[6]>0) {sub$Q90[6]} else {0}),y=(yyy3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[7]<0) {sub$Q2.5[7]} else {0}, if (sub$Q2.5[7]<0) {sub$Q2.5[7]} else {0}, if (sub$Q97.5[7]<0) {sub$Q97.5[7]} else {0}, if (sub$Q97.5[7]<0) {sub$Q97.5[7]} else {0}),y=(yyy1+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[7]<0) {sub$Q5[7]} else {0}, if (sub$Q5[7]<0) {sub$Q5[7]} else {0}, if (sub$Q95[7]<0) {sub$Q95[7]} else {0}, if (sub$Q95[7]<0) {sub$Q95[7]} else {0}),y=(yyy2+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[7]<0) {sub$Q10[7]} else {0}, if (sub$Q10[7]<0) {sub$Q10[7]} else {0}, if (sub$Q90[7]<0) {sub$Q90[7]} else {0}, if (sub$Q90[7]<0) {sub$Q90[7]} else {0}),y=(yyy3+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[7]>0) {sub$Q2.5[7]} else {0}, if (sub$Q2.5[7]>0) {sub$Q2.5[7]} else {0}, if (sub$Q97.5[7]>0) {sub$Q97.5[7]} else {0}, if (sub$Q97.5[7]>0) {sub$Q97.5[7]} else {0}),y=(yyy1+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[7]>0) {sub$Q5[7]} else {0}, if (sub$Q5[7]>0) {sub$Q5[7]} else {0}, if (sub$Q95[7]>0) {sub$Q95[7]} else {0}, if (sub$Q95[7]>0) {sub$Q95[7]} else {0}),y=(yyy2+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[7]>0) {sub$Q10[7]} else {0}, if (sub$Q10[7]>0) {sub$Q10[7]} else {0}, if (sub$Q90[7]>0) {sub$Q90[7]} else {0}, if (sub$Q90[7]>0) {sub$Q90[7]} else {0}),y=(yyy3+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[8]<0) {sub$Q2.5[8]} else {0}, if (sub$Q2.5[8]<0) {sub$Q2.5[8]} else {0}, if (sub$Q97.5[8]<0) {sub$Q97.5[8]} else {0}, if (sub$Q97.5[8]<0) {sub$Q97.5[8]} else {0}),y=(yyy1+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[8]<0) {sub$Q5[8]} else {0}, if (sub$Q5[8]<0) {sub$Q5[8]} else {0}, if (sub$Q95[8]<0) {sub$Q95[8]} else {0}, if (sub$Q95[8]<0) {sub$Q95[8]} else {0}),y=(yyy2+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[8]<0) {sub$Q10[8]} else {0}, if (sub$Q10[8]<0) {sub$Q10[8]} else {0}, if (sub$Q90[8]<0) {sub$Q90[8]} else {0}, if (sub$Q90[8]<0) {sub$Q90[8]} else {0}),y=(yyy3+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[8]>0) {sub$Q2.5[8]} else {0}, if (sub$Q2.5[8]>0) {sub$Q2.5[8]} else {0}, if (sub$Q97.5[8]>0) {sub$Q97.5[8]} else {0}, if (sub$Q97.5[8]>0) {sub$Q97.5[8]} else {0}),y=(yyy1+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[8]>0) {sub$Q5[8]} else {0}, if (sub$Q5[8]>0) {sub$Q5[8]} else {0}, if (sub$Q95[8]>0) {sub$Q95[8]} else {0}, if (sub$Q95[8]>0) {sub$Q95[8]} else {0}),y=(yyy2+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[8]>0) {sub$Q10[8]} else {0}, if (sub$Q10[8]>0) {sub$Q10[8]} else {0}, if (sub$Q90[8]>0) {sub$Q90[8]} else {0}, if (sub$Q90[8]>0) {sub$Q90[8]} else {0}),y=(yyy3+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[9]<0) {sub$Q2.5[9]} else {0}, if (sub$Q2.5[9]<0) {sub$Q2.5[9]} else {0}, if (sub$Q97.5[9]<0) {sub$Q97.5[9]} else {0}, if (sub$Q97.5[9]<0) {sub$Q97.5[9]} else {0}),y=(yyy1+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[9]<0) {sub$Q5[9]} else {0}, if (sub$Q5[9]<0) {sub$Q5[9]} else {0}, if (sub$Q95[9]<0) {sub$Q95[9]} else {0}, if (sub$Q95[9]<0) {sub$Q95[9]} else {0}),y=(yyy2+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[9]<0) {sub$Q10[9]} else {0}, if (sub$Q10[9]<0) {sub$Q10[9]} else {0}, if (sub$Q90[9]<0) {sub$Q90[9]} else {0}, if (sub$Q90[9]<0) {sub$Q90[9]} else {0}),y=(yyy3+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[9]>0) {sub$Q2.5[9]} else {0}, if (sub$Q2.5[9]>0) {sub$Q2.5[9]} else {0}, if (sub$Q97.5[9]>0) {sub$Q97.5[9]} else {0}, if (sub$Q97.5[9]>0) {sub$Q97.5[9]} else {0}),y=(yyy1+3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[9]>0) {sub$Q5[9]} else {0}, if (sub$Q5[9]>0) {sub$Q5[9]} else {0}, if (sub$Q95[9]>0) {sub$Q95[9]} else {0}, if (sub$Q95[9]>0) {sub$Q95[9]} else {0}),y=(yyy2+3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[9]>0) {sub$Q10[9]} else {0}, if (sub$Q10[9]>0) {sub$Q10[9]} else {0}, if (sub$Q90[9]>0) {sub$Q90[9]} else {0}, if (sub$Q90[9]>0) {sub$Q90[9]} else {0}),y=(yyy3+3), col = "dodgerblue", border = NA)

#### RaoQ #####
sub <- subset(drivEst, Response == "RaoQ")
subQ <- c(sub$Q0.5[6:9],sub$Q95[6:9])
est <- sub$Estimate[6:9]
yy <- c(1:4)
plot(yy ~ est, ylab="",xlab="", yaxt="n", las=1, type="n",xlim=c(min(subQ),max(subQ)), ylim=c(0.8,4.8),cex=2, bty="n")
segments(x0=0,y0=0,x1=0,y1=4.18,lty=2, lwd=2,col="grey60")
title(xlab="Estimate", line=2.4,cex.lab=1.3)
legend("topleft", legend=("d, Rao's Q"), bty="n", cex=1.3)
mm <- cbind(yy,est)
mm_neg <- as.data.frame(mm[ which(est < 0),])
mm_pos <- as.data.frame(mm[ which(est > 0),])
#points(yy ~ est, pch="l",cex=2.2,col="white")
points(mm_neg$yy ~ mm_neg$est, pch="l",cex=4,col="firebrick2")
points(mm_pos[1,] ~ mm_pos[2,], pch="l",cex=4,col="dodgerblue")
yyy1=c(0.975,1.025,1.025,0.975)
yyy2=c(0.95,1.05,1.05,0.95)
yyy3=c(0.9,1.1,1.1,0.9)
polygon(x=c(if (sub$Q2.5[6]<0) {sub$Q2.5[6]} else {0}, if (sub$Q2.5[6]<0) {sub$Q2.5[6]} else {0}, if (sub$Q97.5[6]<0) {sub$Q97.5[6]} else {0}, if (sub$Q97.5[6]<0) {sub$Q97.5[6]} else {0}),y=(yyy1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[6]<0) {sub$Q5[6]} else {0}, if (sub$Q5[6]<0) {sub$Q5[6]} else {0}, if (sub$Q95[6]<0) {sub$Q95[6]} else {0}, if (sub$Q95[6]<0) {sub$Q95[6]} else {0}),y=(yyy2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[6]<0) {sub$Q10[6]} else {0}, if (sub$Q10[6]<0) {sub$Q10[6]} else {0}, if (sub$Q90[6]<0) {sub$Q90[6]} else {0}, if (sub$Q90[6]<0) {sub$Q90[6]} else {0}),y=(yyy3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[6]>0) {sub$Q2.5[6]} else {0}, if (sub$Q2.5[6]>0) {sub$Q2.5[6]} else {0}, if (sub$Q97.5[6]>0) {sub$Q97.5[6]} else {0}, if (sub$Q97.5[6]>0) {sub$Q97.5[6]} else {0}),y=(yyy1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[6]>0) {sub$Q5[6]} else {0}, if (sub$Q5[6]>0) {sub$Q5[6]} else {0}, if (sub$Q95[6]>0) {sub$Q95[6]} else {0}, if (sub$Q95[6]>0) {sub$Q95[6]} else {0}),y=(yyy2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[6]>0) {sub$Q10[6]} else {0}, if (sub$Q10[6]>0) {sub$Q10[6]} else {0}, if (sub$Q90[6]>0) {sub$Q90[6]} else {0}, if (sub$Q90[6]>0) {sub$Q90[6]} else {0}),y=(yyy3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[7]<0) {sub$Q2.5[7]} else {0}, if (sub$Q2.5[7]<0) {sub$Q2.5[7]} else {0}, if (sub$Q97.5[7]<0) {sub$Q97.5[7]} else {0}, if (sub$Q97.5[7]<0) {sub$Q97.5[7]} else {0}),y=(yyy1+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[7]<0) {sub$Q5[7]} else {0}, if (sub$Q5[7]<0) {sub$Q5[7]} else {0}, if (sub$Q95[7]<0) {sub$Q95[7]} else {0}, if (sub$Q95[7]<0) {sub$Q95[7]} else {0}),y=(yyy2+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[7]<0) {sub$Q10[7]} else {0}, if (sub$Q10[7]<0) {sub$Q10[7]} else {0}, if (sub$Q90[7]<0) {sub$Q90[7]} else {0}, if (sub$Q90[7]<0) {sub$Q90[7]} else {0}),y=(yyy3+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[7]>0) {sub$Q2.5[7]} else {0}, if (sub$Q2.5[7]>0) {sub$Q2.5[7]} else {0}, if (sub$Q97.5[7]>0) {sub$Q97.5[7]} else {0}, if (sub$Q97.5[7]>0) {sub$Q97.5[7]} else {0}),y=(yyy1+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[7]>0) {sub$Q5[7]} else {0}, if (sub$Q5[7]>0) {sub$Q5[7]} else {0}, if (sub$Q95[7]>0) {sub$Q95[7]} else {0}, if (sub$Q95[7]>0) {sub$Q95[7]} else {0}),y=(yyy2+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[7]>0) {sub$Q10[7]} else {0}, if (sub$Q10[7]>0) {sub$Q10[7]} else {0}, if (sub$Q90[7]>0) {sub$Q90[7]} else {0}, if (sub$Q90[7]>0) {sub$Q90[7]} else {0}),y=(yyy3+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[8]<0) {sub$Q2.5[8]} else {0}, if (sub$Q2.5[8]<0) {sub$Q2.5[8]} else {0}, if (sub$Q97.5[8]<0) {sub$Q97.5[8]} else {0}, if (sub$Q97.5[8]<0) {sub$Q97.5[8]} else {0}),y=(yyy1+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[8]<0) {sub$Q5[8]} else {0}, if (sub$Q5[8]<0) {sub$Q5[8]} else {0}, if (sub$Q95[8]<0) {sub$Q95[8]} else {0}, if (sub$Q95[8]<0) {sub$Q95[8]} else {0}),y=(yyy2+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[8]<0) {sub$Q10[8]} else {0}, if (sub$Q10[8]<0) {sub$Q10[8]} else {0}, if (sub$Q90[8]<0) {sub$Q90[8]} else {0}, if (sub$Q90[8]<0) {sub$Q90[8]} else {0}),y=(yyy3+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[8]>0) {sub$Q2.5[8]} else {0}, if (sub$Q2.5[8]>0) {sub$Q2.5[8]} else {0}, if (sub$Q97.5[8]>0) {sub$Q97.5[8]} else {0}, if (sub$Q97.5[8]>0) {sub$Q97.5[8]} else {0}),y=(yyy1+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[8]>0) {sub$Q5[8]} else {0}, if (sub$Q5[8]>0) {sub$Q5[8]} else {0}, if (sub$Q95[8]>0) {sub$Q95[8]} else {0}, if (sub$Q95[8]>0) {sub$Q95[8]} else {0}),y=(yyy2+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[8]>0) {sub$Q10[8]} else {0}, if (sub$Q10[8]>0) {sub$Q10[8]} else {0}, if (sub$Q90[8]>0) {sub$Q90[8]} else {0}, if (sub$Q90[8]>0) {sub$Q90[8]} else {0}),y=(yyy3+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[9]<0) {sub$Q2.5[9]} else {0}, if (sub$Q2.5[9]<0) {sub$Q2.5[9]} else {0}, if (sub$Q97.5[9]<0) {sub$Q97.5[9]} else {0}, if (sub$Q97.5[9]<0) {sub$Q97.5[9]} else {0}),y=(yyy1+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[9]<0) {sub$Q5[9]} else {0}, if (sub$Q5[9]<0) {sub$Q5[9]} else {0}, if (sub$Q95[9]<0) {sub$Q95[9]} else {0}, if (sub$Q95[9]<0) {sub$Q95[9]} else {0}),y=(yyy2+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[9]<0) {sub$Q10[9]} else {0}, if (sub$Q10[9]<0) {sub$Q10[9]} else {0}, if (sub$Q90[9]<0) {sub$Q90[9]} else {0}, if (sub$Q90[9]<0) {sub$Q90[9]} else {0}),y=(yyy3+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[9]>0) {sub$Q2.5[9]} else {0}, if (sub$Q2.5[9]>0) {sub$Q2.5[9]} else {0}, if (sub$Q97.5[9]>0) {sub$Q97.5[9]} else {0}, if (sub$Q97.5[9]>0) {sub$Q97.5[9]} else {0}),y=(yyy1+3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[9]>0) {sub$Q5[9]} else {0}, if (sub$Q5[9]>0) {sub$Q5[9]} else {0}, if (sub$Q95[9]>0) {sub$Q95[9]} else {0}, if (sub$Q95[9]>0) {sub$Q95[9]} else {0}),y=(yyy2+3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[9]>0) {sub$Q10[9]} else {0}, if (sub$Q10[9]>0) {sub$Q10[9]} else {0}, if (sub$Q90[9]>0) {sub$Q90[9]} else {0}, if (sub$Q90[9]>0) {sub$Q90[9]} else {0}),y=(yyy3+3), col = "dodgerblue", border = NA)
##

##
dev.off()
##

