##Set working directory
setwd("C:/Users/ewelti/Desktop/git/EuroAquaticMacroInverts/")

# attach data
drivEst <- read.csv("outputs/Driver_metaanaly_Ests.csv")
#drivEst <- read.csv("outputs/Driver_horseshoe_metaanaly_Ests.csv")
head(drivEst)
unique(drivEst$Response)

options(scipen=999)

##save plot
tiff(filename = "plots/Fig4_drivers/Drivers_TaxaFunc_extra.tiff", width = 5, height = 5, units = 'in', res = 600, compression = 'lzw')
#tiff(filename = "plots/drivers/Drivers_horseshoe.tiff", width = 8, height = 9, units = 'in', res = 600, compression = 'lzw')

##layout
layout(mat = matrix(c(1:6), 
                        nrow = 2, 
                        ncol = 3),
       heights = c(2,2,2,2,2,2),
       widths = c(0.8,2,2,0.8,2,2))

par(mar=c(4,0.4,0.4,0.8))
#empty plot for where the labels will go
plot(0, xaxt = 'n', yaxt = 'n', bty = 'n', pch = '', ylab = '', xlab = '')
plot(0, xaxt = 'n', yaxt = 'n', bty = 'n', pch = '', ylab = '', xlab = '')

#### shannonsH #####
sub <- subset(drivEst, Response == "shannonsH")
est1 <- sub$Estimate[2:5]
est2 <- sub$Estimate[10:12]
est <- c(est1,est2)
yy <- c(5,7,6,8,3,2,4)
plot(yy ~ est, ylab="",xlab="", yaxt="n", las=1, type="n",xlim=c(-0.008,0.007), ylim=c(1.7,9.4),cex=2, bty="n")
#polygon(x=c(-100,-100,0,0),
#        y=c(-4,22,22,-4), col = "grey80", border = "grey80")
segments(x0=0,y0=0,x1=0,y1=8.4,lty=2, lwd=2,col="grey60")
axis(2, at=yy, lwd = 0, lwd.ticks = 0, labels=c("ppt sl.","tmax sl.",  "ppt mean", "tmax mean",
				#"str. order", "accum.", "elevation", "slope",
  				"urban","crop", "dam"), las=1,cex.axis=1.3)
title(xlab="Estimate", line=2.4,cex.lab=1.3)
legend("topleft", legend=("a) Shannon's H"), bty="n", cex=1.3)
mm <- cbind(yy,est)
mm_neg <- as.data.frame(mm[ which(est < 0),])
mm_pos <- as.data.frame(mm[ which(est > 0),])
#points(yy ~ est, pch="l",cex=2.2,col="white")
points(mm_neg$yy ~ mm_neg$est, pch="l",cex=2,col="firebrick2")
points(mm_pos$yy ~ mm_pos$est, pch="l",cex=2,col="dodgerblue")
yyy1=c(0.975,1.025,1.025,0.975)
yyy2=c(0.95,1.05,1.05,0.95)
yyy3=c(0.9,1.1,1.1,0.9)
polygon(x=c(if (sub$Q2.5[11]<0) {sub$Q2.5[11]} else {0}, if (sub$Q2.5[11]<0) {sub$Q2.5[11]} else {0}, if (sub$Q97.5[11]<0) {sub$Q97.5[11]} else {0}, if (sub$Q97.5[11]<0) {sub$Q97.5[11]} else {0}),y=(yyy1+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[11]<0) {sub$Q5[11]} else {0}, if (sub$Q5[11]<0) {sub$Q5[11]} else {0}, if (sub$Q95[11]<0) {sub$Q95[11]} else {0}, if (sub$Q95[11]<0) {sub$Q95[11]} else {0}),y=(yyy2+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[11]<0) {sub$Q10[11]} else {0}, if (sub$Q10[11]<0) {sub$Q10[11]} else {0}, if (sub$Q90[11]<0) {sub$Q90[11]} else {0}, if (sub$Q90[11]<0) {sub$Q90[11]} else {0}),y=(yyy3+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[11]>0) {sub$Q2.5[11]} else {0}, if (sub$Q2.5[11]>0) {sub$Q2.5[11]} else {0}, if (sub$Q97.5[11]>0) {sub$Q97.5[11]} else {0}, if (sub$Q97.5[11]>0) {sub$Q97.5[11]} else {0}),y=(yyy1+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[11]>0) {sub$Q5[11]} else {0}, if (sub$Q5[11]>0) {sub$Q5[11]} else {0}, if (sub$Q95[11]>0) {sub$Q95[11]} else {0}, if (sub$Q95[11]>0) {sub$Q95[11]} else {0}),y=(yyy2+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[11]>0) {sub$Q10[11]} else {0}, if (sub$Q10[11]>0) {sub$Q10[11]} else {0}, if (sub$Q90[11]>0) {sub$Q90[11]} else {0}, if (sub$Q90[11]>0) {sub$Q90[11]} else {0}),y=(yyy3+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[10]<0) {sub$Q2.5[10]} else {0}, if (sub$Q2.5[10]<0) {sub$Q2.5[10]} else {0}, if (sub$Q97.5[10]<0) {sub$Q97.5[10]} else {0}, if (sub$Q97.5[10]<0) {sub$Q97.5[10]} else {0}),y=(yyy1+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[10]<0) {sub$Q5[10]} else {0}, if (sub$Q5[10]<0) {sub$Q5[10]} else {0}, if (sub$Q95[10]<0) {sub$Q95[10]} else {0}, if (sub$Q95[10]<0) {sub$Q95[10]} else {0}),y=(yyy2+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[10]<0) {sub$Q10[10]} else {0}, if (sub$Q10[10]<0) {sub$Q10[10]} else {0}, if (sub$Q90[10]<0) {sub$Q90[10]} else {0}, if (sub$Q90[10]<0) {sub$Q90[10]} else {0}),y=(yyy3+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[10]>0) {sub$Q2.5[10]} else {0}, if (sub$Q2.5[10]>0) {sub$Q2.5[10]} else {0}, if (sub$Q97.5[10]>0) {sub$Q97.5[10]} else {0}, if (sub$Q97.5[10]>0) {sub$Q97.5[10]} else {0}),y=(yyy1+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[10]>0) {sub$Q5[10]} else {0}, if (sub$Q5[10]>0) {sub$Q5[10]} else {0}, if (sub$Q95[10]>0) {sub$Q95[10]} else {0}, if (sub$Q95[10]>0) {sub$Q95[10]} else {0}),y=(yyy2+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[10]>0) {sub$Q10[10]} else {0}, if (sub$Q10[10]>0) {sub$Q10[10]} else {0}, if (sub$Q90[10]>0) {sub$Q90[10]} else {0}, if (sub$Q90[10]>0) {sub$Q90[10]} else {0}),y=(yyy3+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[12]<0) {sub$Q2.5[12]} else {0}, if (sub$Q2.5[12]<0) {sub$Q2.5[12]} else {0}, if (sub$Q97.5[12]<0) {sub$Q97.5[12]} else {0}, if (sub$Q97.5[12]<0) {sub$Q97.5[12]} else {0}),y=(yyy1+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[12]<0) {sub$Q5[12]} else {0}, if (sub$Q5[12]<0) {sub$Q5[12]} else {0}, if (sub$Q95[12]<0) {sub$Q95[12]} else {0}, if (sub$Q95[12]<0) {sub$Q95[12]} else {0}),y=(yyy2+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[12]<0) {sub$Q10[12]} else {0}, if (sub$Q10[12]<0) {sub$Q10[12]} else {0}, if (sub$Q90[12]<0) {sub$Q90[12]} else {0}, if (sub$Q90[12]<0) {sub$Q90[12]} else {0}),y=(yyy3+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[12]>0) {sub$Q2.5[12]} else {0}, if (sub$Q2.5[12]>0) {sub$Q2.5[12]} else {0}, if (sub$Q97.5[12]>0) {sub$Q97.5[12]} else {0}, if (sub$Q97.5[12]>0) {sub$Q97.5[12]} else {0}),y=(yyy1+3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[12]>0) {sub$Q5[12]} else {0}, if (sub$Q5[12]>0) {sub$Q5[12]} else {0}, if (sub$Q95[12]>0) {sub$Q95[12]} else {0}, if (sub$Q95[12]>0) {sub$Q95[12]} else {0}),y=(yyy2+3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[12]>0) {sub$Q10[12]} else {0}, if (sub$Q10[12]>0) {sub$Q10[12]} else {0}, if (sub$Q90[12]>0) {sub$Q90[12]} else {0}, if (sub$Q90[12]>0) {sub$Q90[12]} else {0}),y=(yyy3+3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[2]<0) {sub$Q2.5[2]} else {0}, if (sub$Q2.5[2]<0) {sub$Q2.5[2]} else {0}, if (sub$Q97.5[2]<0) {sub$Q97.5[2]} else {0}, if (sub$Q97.5[2]<0) {sub$Q97.5[2]} else {0}),y=(yyy1+4), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[2]<0) {sub$Q5[2]} else {0}, if (sub$Q5[2]<0) {sub$Q5[2]} else {0}, if (sub$Q95[2]<0) {sub$Q95[2]} else {0}, if (sub$Q95[2]<0) {sub$Q95[2]} else {0}),y=(yyy2+4), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[2]<0) {sub$Q10[2]} else {0}, if (sub$Q10[2]<0) {sub$Q10[2]} else {0}, if (sub$Q90[2]<0) {sub$Q90[2]} else {0}, if (sub$Q90[2]<0) {sub$Q90[2]} else {0}),y=(yyy3+4), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[2]>0) {sub$Q2.5[2]} else {0}, if (sub$Q2.5[2]>0) {sub$Q2.5[2]} else {0}, if (sub$Q97.5[2]>0) {sub$Q97.5[2]} else {0}, if (sub$Q97.5[2]>0) {sub$Q97.5[2]} else {0}),y=(yyy1+4), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[2]>0) {sub$Q5[2]} else {0}, if (sub$Q5[2]>0) {sub$Q5[2]} else {0}, if (sub$Q95[2]>0) {sub$Q95[2]} else {0}, if (sub$Q95[2]>0) {sub$Q95[2]} else {0}),y=(yyy2+4), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[2]>0) {sub$Q10[2]} else {0}, if (sub$Q10[2]>0) {sub$Q10[2]} else {0}, if (sub$Q90[2]>0) {sub$Q90[2]} else {0}, if (sub$Q90[2]>0) {sub$Q90[2]} else {0}),y=(yyy3+4), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[4]<0) {sub$Q2.5[4]} else {0}, if (sub$Q2.5[4]<0) {sub$Q2.5[4]} else {0}, if (sub$Q97.5[4]<0) {sub$Q97.5[4]} else {0}, if (sub$Q97.5[4]<0) {sub$Q97.5[4]} else {0}),y=(yyy1+5), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[4]<0) {sub$Q5[4]} else {0}, if (sub$Q5[4]<0) {sub$Q5[4]} else {0}, if (sub$Q95[4]<0) {sub$Q95[4]} else {0}, if (sub$Q95[4]<0) {sub$Q95[4]} else {0}),y=(yyy2+5), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[4]<0) {sub$Q10[4]} else {0}, if (sub$Q10[4]<0) {sub$Q10[4]} else {0}, if (sub$Q90[4]<0) {sub$Q90[4]} else {0}, if (sub$Q90[4]<0) {sub$Q90[4]} else {0}),y=(yyy3+5), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[4]>0) {sub$Q2.5[4]} else {0}, if (sub$Q2.5[4]>0) {sub$Q2.5[4]} else {0}, if (sub$Q97.5[4]>0) {sub$Q97.5[4]} else {0}, if (sub$Q97.5[4]>0) {sub$Q97.5[4]} else {0}),y=(yyy1+5), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[4]>0) {sub$Q5[4]} else {0}, if (sub$Q5[4]>0) {sub$Q5[4]} else {0}, if (sub$Q95[4]>0) {sub$Q95[4]} else {0}, if (sub$Q95[4]>0) {sub$Q95[4]} else {0}),y=(yyy2+5), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[4]>0) {sub$Q10[4]} else {0}, if (sub$Q10[4]>0) {sub$Q10[4]} else {0}, if (sub$Q90[4]>0) {sub$Q90[4]} else {0}, if (sub$Q90[4]>0) {sub$Q90[4]} else {0}),y=(yyy3+5), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[3]<0) {sub$Q2.5[3]} else {0}, if (sub$Q2.5[3]<0) {sub$Q2.5[3]} else {0}, if (sub$Q97.5[3]<0) {sub$Q97.5[3]} else {0}, if (sub$Q97.5[3]<0) {sub$Q97.5[3]} else {0}),y=(yyy1+6), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[3]<0) {sub$Q5[3]} else {0}, if (sub$Q5[3]<0) {sub$Q5[3]} else {0}, if (sub$Q95[3]<0) {sub$Q95[3]} else {0}, if (sub$Q95[3]<0) {sub$Q95[3]} else {0}),y=(yyy2+6), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[3]<0) {sub$Q10[3]} else {0}, if (sub$Q10[3]<0) {sub$Q10[3]} else {0}, if (sub$Q90[3]<0) {sub$Q90[3]} else {0}, if (sub$Q90[3]<0) {sub$Q90[3]} else {0}),y=(yyy3+6), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[3]>0) {sub$Q2.5[3]} else {0}, if (sub$Q2.5[3]>0) {sub$Q2.5[3]} else {0}, if (sub$Q97.5[3]>0) {sub$Q97.5[3]} else {0}, if (sub$Q97.5[3]>0) {sub$Q97.5[3]} else {0}),y=(yyy1+6), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[3]>0) {sub$Q5[3]} else {0}, if (sub$Q5[3]>0) {sub$Q5[3]} else {0}, if (sub$Q95[3]>0) {sub$Q95[3]} else {0}, if (sub$Q95[3]>0) {sub$Q95[3]} else {0}),y=(yyy2+6), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[3]>0) {sub$Q10[3]} else {0}, if (sub$Q10[3]>0) {sub$Q10[3]} else {0}, if (sub$Q90[3]>0) {sub$Q90[3]} else {0}, if (sub$Q90[3]>0) {sub$Q90[3]} else {0}),y=(yyy3+6), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[5]<0) {sub$Q2.5[5]} else {0}, if (sub$Q2.5[5]<0) {sub$Q2.5[5]} else {0}, if (sub$Q97.5[5]<0) {sub$Q97.5[5]} else {0}, if (sub$Q97.5[5]<0) {sub$Q97.5[5]} else {0}),y=(yyy1+7), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[5]<0) {sub$Q5[5]} else {0}, if (sub$Q5[5]<0) {sub$Q5[5]} else {0}, if (sub$Q95[5]<0) {sub$Q95[5]} else {0}, if (sub$Q95[5]<0) {sub$Q95[5]} else {0}),y=(yyy2+7), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[5]<0) {sub$Q10[5]} else {0}, if (sub$Q10[5]<0) {sub$Q10[5]} else {0}, if (sub$Q90[5]<0) {sub$Q90[5]} else {0}, if (sub$Q90[5]<0) {sub$Q90[5]} else {0}),y=(yyy3+7), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[5]>0) {sub$Q2.5[5]} else {0}, if (sub$Q2.5[5]>0) {sub$Q2.5[5]} else {0}, if (sub$Q97.5[5]>0) {sub$Q97.5[5]} else {0}, if (sub$Q97.5[5]>0) {sub$Q97.5[5]} else {0}),y=(yyy1+7), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[5]>0) {sub$Q5[5]} else {0}, if (sub$Q5[5]>0) {sub$Q5[5]} else {0}, if (sub$Q95[5]>0) {sub$Q95[5]} else {0}, if (sub$Q95[5]>0) {sub$Q95[5]} else {0}),y=(yyy2+7), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[5]>0) {sub$Q10[5]} else {0}, if (sub$Q10[5]>0) {sub$Q10[5]} else {0}, if (sub$Q90[5]>0) {sub$Q90[5]} else {0}, if (sub$Q90[5]>0) {sub$Q90[5]} else {0}),y=(yyy3+7), col = "dodgerblue", border = NA)
abline(h=3.5,lty=2, col="grey60")
abline(h=4.5,lty=2, col="grey60")

#### func_diverg #####
sub <- subset(drivEst, Response == "func_diverg")
est1 <- sub$Estimate[2:5]
est2 <- sub$Estimate[10:12]
est <- c(est1,est2)
plot(yy ~ est, ylab="",xlab="", yaxt="n", las=1, type="n",xlim=c(-0.004,0.0045), ylim=c(1.7,9.4), cex=2, bty="n")
segments(x0=0,y0=0,x1=0,y1=8.4,lty=2, lwd=2,col="grey60")
title(xlab="Estimate", line=2.4,cex.lab=1.3)
axis(2, at=yy, lwd = 0, lwd.ticks = 0, labels=c("ppt sl.","tmax sl.",  "ppt mean", "tmax mean",
				#"str. order", "accum.", "elevation", "slope",
  				"urban","crop", "dam"), las=1,cex.axis=1.3)
legend("topleft", legend=("c) Func. divergence"), bty="n", cex=1.3)
mm <- cbind(yy,est)
mm_neg <- as.data.frame(mm[ which(est < 0),])
mm_pos <- as.data.frame(mm[ which(est > 0),])
points(mm_neg$yy ~ mm_neg$est, pch="l",cex=2,col="firebrick2")
points(mm_pos$yy ~ mm_pos$est, pch="l",cex=2,col="dodgerblue")
yyy1=c(0.975,1.025,1.025,0.975)
yyy2=c(0.95,1.05,1.05,0.95)
yyy3=c(0.9,1.1,1.1,0.9)
polygon(x=c(if (sub$Q2.5[11]<0) {sub$Q2.5[11]} else {0}, if (sub$Q2.5[11]<0) {sub$Q2.5[11]} else {0}, if (sub$Q97.5[11]<0) {sub$Q97.5[11]} else {0}, if (sub$Q97.5[11]<0) {sub$Q97.5[11]} else {0}),y=(yyy1+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[11]<0) {sub$Q5[11]} else {0}, if (sub$Q5[11]<0) {sub$Q5[11]} else {0}, if (sub$Q95[11]<0) {sub$Q95[11]} else {0}, if (sub$Q95[11]<0) {sub$Q95[11]} else {0}),y=(yyy2+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[11]<0) {sub$Q10[11]} else {0}, if (sub$Q10[11]<0) {sub$Q10[11]} else {0}, if (sub$Q90[11]<0) {sub$Q90[11]} else {0}, if (sub$Q90[11]<0) {sub$Q90[11]} else {0}),y=(yyy3+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[11]>0) {sub$Q2.5[11]} else {0}, if (sub$Q2.5[11]>0) {sub$Q2.5[11]} else {0}, if (sub$Q97.5[11]>0) {sub$Q97.5[11]} else {0}, if (sub$Q97.5[11]>0) {sub$Q97.5[11]} else {0}),y=(yyy1+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[11]>0) {sub$Q5[11]} else {0}, if (sub$Q5[11]>0) {sub$Q5[11]} else {0}, if (sub$Q95[11]>0) {sub$Q95[11]} else {0}, if (sub$Q95[11]>0) {sub$Q95[11]} else {0}),y=(yyy2+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[11]>0) {sub$Q10[11]} else {0}, if (sub$Q10[11]>0) {sub$Q10[11]} else {0}, if (sub$Q90[11]>0) {sub$Q90[11]} else {0}, if (sub$Q90[11]>0) {sub$Q90[11]} else {0}),y=(yyy3+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[10]<0) {sub$Q2.5[10]} else {0}, if (sub$Q2.5[10]<0) {sub$Q2.5[10]} else {0}, if (sub$Q97.5[10]<0) {sub$Q97.5[10]} else {0}, if (sub$Q97.5[10]<0) {sub$Q97.5[10]} else {0}),y=(yyy1+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[10]<0) {sub$Q5[10]} else {0}, if (sub$Q5[10]<0) {sub$Q5[10]} else {0}, if (sub$Q95[10]<0) {sub$Q95[10]} else {0}, if (sub$Q95[10]<0) {sub$Q95[10]} else {0}),y=(yyy2+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[10]<0) {sub$Q10[10]} else {0}, if (sub$Q10[10]<0) {sub$Q10[10]} else {0}, if (sub$Q90[10]<0) {sub$Q90[10]} else {0}, if (sub$Q90[10]<0) {sub$Q90[10]} else {0}),y=(yyy3+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[10]>0) {sub$Q2.5[10]} else {0}, if (sub$Q2.5[10]>0) {sub$Q2.5[10]} else {0}, if (sub$Q97.5[10]>0) {sub$Q97.5[10]} else {0}, if (sub$Q97.5[10]>0) {sub$Q97.5[10]} else {0}),y=(yyy1+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[10]>0) {sub$Q5[10]} else {0}, if (sub$Q5[10]>0) {sub$Q5[10]} else {0}, if (sub$Q95[10]>0) {sub$Q95[10]} else {0}, if (sub$Q95[10]>0) {sub$Q95[10]} else {0}),y=(yyy2+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[10]>0) {sub$Q10[10]} else {0}, if (sub$Q10[10]>0) {sub$Q10[10]} else {0}, if (sub$Q90[10]>0) {sub$Q90[10]} else {0}, if (sub$Q90[10]>0) {sub$Q90[10]} else {0}),y=(yyy3+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[12]<0) {sub$Q2.5[12]} else {0}, if (sub$Q2.5[12]<0) {sub$Q2.5[12]} else {0}, if (sub$Q97.5[12]<0) {sub$Q97.5[12]} else {0}, if (sub$Q97.5[12]<0) {sub$Q97.5[12]} else {0}),y=(yyy1+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[12]<0) {sub$Q5[12]} else {0}, if (sub$Q5[12]<0) {sub$Q5[12]} else {0}, if (sub$Q95[12]<0) {sub$Q95[12]} else {0}, if (sub$Q95[12]<0) {sub$Q95[12]} else {0}),y=(yyy2+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[12]<0) {sub$Q10[12]} else {0}, if (sub$Q10[12]<0) {sub$Q10[12]} else {0}, if (sub$Q90[12]<0) {sub$Q90[12]} else {0}, if (sub$Q90[12]<0) {sub$Q90[12]} else {0}),y=(yyy3+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[12]>0) {sub$Q2.5[12]} else {0}, if (sub$Q2.5[12]>0) {sub$Q2.5[12]} else {0}, if (sub$Q97.5[12]>0) {sub$Q97.5[12]} else {0}, if (sub$Q97.5[12]>0) {sub$Q97.5[12]} else {0}),y=(yyy1+3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[12]>0) {sub$Q5[12]} else {0}, if (sub$Q5[12]>0) {sub$Q5[12]} else {0}, if (sub$Q95[12]>0) {sub$Q95[12]} else {0}, if (sub$Q95[12]>0) {sub$Q95[12]} else {0}),y=(yyy2+3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[12]>0) {sub$Q10[12]} else {0}, if (sub$Q10[12]>0) {sub$Q10[12]} else {0}, if (sub$Q90[12]>0) {sub$Q90[12]} else {0}, if (sub$Q90[12]>0) {sub$Q90[12]} else {0}),y=(yyy3+3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[2]<0) {sub$Q2.5[2]} else {0}, if (sub$Q2.5[2]<0) {sub$Q2.5[2]} else {0}, if (sub$Q97.5[2]<0) {sub$Q97.5[2]} else {0}, if (sub$Q97.5[2]<0) {sub$Q97.5[2]} else {0}),y=(yyy1+4), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[2]<0) {sub$Q5[2]} else {0}, if (sub$Q5[2]<0) {sub$Q5[2]} else {0}, if (sub$Q95[2]<0) {sub$Q95[2]} else {0}, if (sub$Q95[2]<0) {sub$Q95[2]} else {0}),y=(yyy2+4), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[2]<0) {sub$Q10[2]} else {0}, if (sub$Q10[2]<0) {sub$Q10[2]} else {0}, if (sub$Q90[2]<0) {sub$Q90[2]} else {0}, if (sub$Q90[2]<0) {sub$Q90[2]} else {0}),y=(yyy3+4), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[2]>0) {sub$Q2.5[2]} else {0}, if (sub$Q2.5[2]>0) {sub$Q2.5[2]} else {0}, if (sub$Q97.5[2]>0) {sub$Q97.5[2]} else {0}, if (sub$Q97.5[2]>0) {sub$Q97.5[2]} else {0}),y=(yyy1+4), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[2]>0) {sub$Q5[2]} else {0}, if (sub$Q5[2]>0) {sub$Q5[2]} else {0}, if (sub$Q95[2]>0) {sub$Q95[2]} else {0}, if (sub$Q95[2]>0) {sub$Q95[2]} else {0}),y=(yyy2+4), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[2]>0) {sub$Q10[2]} else {0}, if (sub$Q10[2]>0) {sub$Q10[2]} else {0}, if (sub$Q90[2]>0) {sub$Q90[2]} else {0}, if (sub$Q90[2]>0) {sub$Q90[2]} else {0}),y=(yyy3+4), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[4]<0) {sub$Q2.5[4]} else {0}, if (sub$Q2.5[4]<0) {sub$Q2.5[4]} else {0}, if (sub$Q97.5[4]<0) {sub$Q97.5[4]} else {0}, if (sub$Q97.5[4]<0) {sub$Q97.5[4]} else {0}),y=(yyy1+5), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[4]<0) {sub$Q5[4]} else {0}, if (sub$Q5[4]<0) {sub$Q5[4]} else {0}, if (sub$Q95[4]<0) {sub$Q95[4]} else {0}, if (sub$Q95[4]<0) {sub$Q95[4]} else {0}),y=(yyy2+5), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[4]<0) {sub$Q10[4]} else {0}, if (sub$Q10[4]<0) {sub$Q10[4]} else {0}, if (sub$Q90[4]<0) {sub$Q90[4]} else {0}, if (sub$Q90[4]<0) {sub$Q90[4]} else {0}),y=(yyy3+5), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[4]>0) {sub$Q2.5[4]} else {0}, if (sub$Q2.5[4]>0) {sub$Q2.5[4]} else {0}, if (sub$Q97.5[4]>0) {sub$Q97.5[4]} else {0}, if (sub$Q97.5[4]>0) {sub$Q97.5[4]} else {0}),y=(yyy1+5), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[4]>0) {sub$Q5[4]} else {0}, if (sub$Q5[4]>0) {sub$Q5[4]} else {0}, if (sub$Q95[4]>0) {sub$Q95[4]} else {0}, if (sub$Q95[4]>0) {sub$Q95[4]} else {0}),y=(yyy2+5), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[4]>0) {sub$Q10[4]} else {0}, if (sub$Q10[4]>0) {sub$Q10[4]} else {0}, if (sub$Q90[4]>0) {sub$Q90[4]} else {0}, if (sub$Q90[4]>0) {sub$Q90[4]} else {0}),y=(yyy3+5), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[3]<0) {sub$Q2.5[3]} else {0}, if (sub$Q2.5[3]<0) {sub$Q2.5[3]} else {0}, if (sub$Q97.5[3]<0) {sub$Q97.5[3]} else {0}, if (sub$Q97.5[3]<0) {sub$Q97.5[3]} else {0}),y=(yyy1+6), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[3]<0) {sub$Q5[3]} else {0}, if (sub$Q5[3]<0) {sub$Q5[3]} else {0}, if (sub$Q95[3]<0) {sub$Q95[3]} else {0}, if (sub$Q95[3]<0) {sub$Q95[3]} else {0}),y=(yyy2+6), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[3]<0) {sub$Q10[3]} else {0}, if (sub$Q10[3]<0) {sub$Q10[3]} else {0}, if (sub$Q90[3]<0) {sub$Q90[3]} else {0}, if (sub$Q90[3]<0) {sub$Q90[3]} else {0}),y=(yyy3+6), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[3]>0) {sub$Q2.5[3]} else {0}, if (sub$Q2.5[3]>0) {sub$Q2.5[3]} else {0}, if (sub$Q97.5[3]>0) {sub$Q97.5[3]} else {0}, if (sub$Q97.5[3]>0) {sub$Q97.5[3]} else {0}),y=(yyy1+6), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[3]>0) {sub$Q5[3]} else {0}, if (sub$Q5[3]>0) {sub$Q5[3]} else {0}, if (sub$Q95[3]>0) {sub$Q95[3]} else {0}, if (sub$Q95[3]>0) {sub$Q95[3]} else {0}),y=(yyy2+6), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[3]>0) {sub$Q10[3]} else {0}, if (sub$Q10[3]>0) {sub$Q10[3]} else {0}, if (sub$Q90[3]>0) {sub$Q90[3]} else {0}, if (sub$Q90[3]>0) {sub$Q90[3]} else {0}),y=(yyy3+6), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[5]<0) {sub$Q2.5[5]} else {0}, if (sub$Q2.5[5]<0) {sub$Q2.5[5]} else {0}, if (sub$Q97.5[5]<0) {sub$Q97.5[5]} else {0}, if (sub$Q97.5[5]<0) {sub$Q97.5[5]} else {0}),y=(yyy1+7), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[5]<0) {sub$Q5[5]} else {0}, if (sub$Q5[5]<0) {sub$Q5[5]} else {0}, if (sub$Q95[5]<0) {sub$Q95[5]} else {0}, if (sub$Q95[5]<0) {sub$Q95[5]} else {0}),y=(yyy2+7), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[5]<0) {sub$Q10[5]} else {0}, if (sub$Q10[5]<0) {sub$Q10[5]} else {0}, if (sub$Q90[5]<0) {sub$Q90[5]} else {0}, if (sub$Q90[5]<0) {sub$Q90[5]} else {0}),y=(yyy3+7), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[5]>0) {sub$Q2.5[5]} else {0}, if (sub$Q2.5[5]>0) {sub$Q2.5[5]} else {0}, if (sub$Q97.5[5]>0) {sub$Q97.5[5]} else {0}, if (sub$Q97.5[5]>0) {sub$Q97.5[5]} else {0}),y=(yyy1+7), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[5]>0) {sub$Q5[5]} else {0}, if (sub$Q5[5]>0) {sub$Q5[5]} else {0}, if (sub$Q95[5]>0) {sub$Q95[5]} else {0}, if (sub$Q95[5]>0) {sub$Q95[5]} else {0}),y=(yyy2+7), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[5]>0) {sub$Q10[5]} else {0}, if (sub$Q10[5]>0) {sub$Q10[5]} else {0}, if (sub$Q90[5]>0) {sub$Q90[5]} else {0}, if (sub$Q90[5]>0) {sub$Q90[5]} else {0}),y=(yyy3+7), col = "dodgerblue", border = NA)
abline(h=3.5,lty=2, col="grey60")
abline(h=4.5,lty=2, col="grey60")

#### spp_richness_rarefied #####
sub <- subset(drivEst, Response == "spp_richness_rarefied")
est1 <- sub$Estimate[2:5]
est2 <- sub$Estimate[10:12]
est <- c(est1,est2)
plot(yy ~ est, ylab="",xlab="", yaxt="n", las=1, type="n",xlim=c(-0.07,0.05), ylim=c(1.7,9.4), cex=2, bty="n")
segments(x0=0,y0=0,x1=0,y1=8.4,lty=2, lwd=2,col="grey60")
title(xlab="Estimate", line=2.4,cex.lab=1.3)
legend("topleft", legend=("b) Rarefied richness"), bty="n", cex=1.3)
mm <- cbind(yy,est)
mm_neg <- as.data.frame(mm[ which(est < 0),])
mm_pos <- as.data.frame(mm[ which(est > 0),])
#points(yy ~ est, pch="l",cex=2.2,col="white")
points(mm_neg$yy ~ mm_neg$est, pch="l",cex=2,col="firebrick2")
points(mm_pos$yy ~ mm_pos$est, pch="l",cex=2,col="dodgerblue")
yyy1=c(0.975,1.025,1.025,0.975)
yyy2=c(0.95,1.05,1.05,0.95)
yyy3=c(0.9,1.1,1.1,0.9)
polygon(x=c(if (sub$Q2.5[11]<0) {sub$Q2.5[11]} else {0}, if (sub$Q2.5[11]<0) {sub$Q2.5[11]} else {0}, if (sub$Q97.5[11]<0) {sub$Q97.5[11]} else {0}, if (sub$Q97.5[11]<0) {sub$Q97.5[11]} else {0}),y=(yyy1+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[11]<0) {sub$Q5[11]} else {0}, if (sub$Q5[11]<0) {sub$Q5[11]} else {0}, if (sub$Q95[11]<0) {sub$Q95[11]} else {0}, if (sub$Q95[11]<0) {sub$Q95[11]} else {0}),y=(yyy2+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[11]<0) {sub$Q10[11]} else {0}, if (sub$Q10[11]<0) {sub$Q10[11]} else {0}, if (sub$Q90[11]<0) {sub$Q90[11]} else {0}, if (sub$Q90[11]<0) {sub$Q90[11]} else {0}),y=(yyy3+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[11]>0) {sub$Q2.5[11]} else {0}, if (sub$Q2.5[11]>0) {sub$Q2.5[11]} else {0}, if (sub$Q97.5[11]>0) {sub$Q97.5[11]} else {0}, if (sub$Q97.5[11]>0) {sub$Q97.5[11]} else {0}),y=(yyy1+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[11]>0) {sub$Q5[11]} else {0}, if (sub$Q5[11]>0) {sub$Q5[11]} else {0}, if (sub$Q95[11]>0) {sub$Q95[11]} else {0}, if (sub$Q95[11]>0) {sub$Q95[11]} else {0}),y=(yyy2+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[11]>0) {sub$Q10[11]} else {0}, if (sub$Q10[11]>0) {sub$Q10[11]} else {0}, if (sub$Q90[11]>0) {sub$Q90[11]} else {0}, if (sub$Q90[11]>0) {sub$Q90[11]} else {0}),y=(yyy3+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[10]<0) {sub$Q2.5[10]} else {0}, if (sub$Q2.5[10]<0) {sub$Q2.5[10]} else {0}, if (sub$Q97.5[10]<0) {sub$Q97.5[10]} else {0}, if (sub$Q97.5[10]<0) {sub$Q97.5[10]} else {0}),y=(yyy1+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[10]<0) {sub$Q5[10]} else {0}, if (sub$Q5[10]<0) {sub$Q5[10]} else {0}, if (sub$Q95[10]<0) {sub$Q95[10]} else {0}, if (sub$Q95[10]<0) {sub$Q95[10]} else {0}),y=(yyy2+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[10]<0) {sub$Q10[10]} else {0}, if (sub$Q10[10]<0) {sub$Q10[10]} else {0}, if (sub$Q90[10]<0) {sub$Q90[10]} else {0}, if (sub$Q90[10]<0) {sub$Q90[10]} else {0}),y=(yyy3+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[10]>0) {sub$Q2.5[10]} else {0}, if (sub$Q2.5[10]>0) {sub$Q2.5[10]} else {0}, if (sub$Q97.5[10]>0) {sub$Q97.5[10]} else {0}, if (sub$Q97.5[10]>0) {sub$Q97.5[10]} else {0}),y=(yyy1+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[10]>0) {sub$Q5[10]} else {0}, if (sub$Q5[10]>0) {sub$Q5[10]} else {0}, if (sub$Q95[10]>0) {sub$Q95[10]} else {0}, if (sub$Q95[10]>0) {sub$Q95[10]} else {0}),y=(yyy2+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[10]>0) {sub$Q10[10]} else {0}, if (sub$Q10[10]>0) {sub$Q10[10]} else {0}, if (sub$Q90[10]>0) {sub$Q90[10]} else {0}, if (sub$Q90[10]>0) {sub$Q90[10]} else {0}),y=(yyy3+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[12]<0) {sub$Q2.5[12]} else {0}, if (sub$Q2.5[12]<0) {sub$Q2.5[12]} else {0}, if (sub$Q97.5[12]<0) {sub$Q97.5[12]} else {0}, if (sub$Q97.5[12]<0) {sub$Q97.5[12]} else {0}),y=(yyy1+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[12]<0) {sub$Q5[12]} else {0}, if (sub$Q5[12]<0) {sub$Q5[12]} else {0}, if (sub$Q95[12]<0) {sub$Q95[12]} else {0}, if (sub$Q95[12]<0) {sub$Q95[12]} else {0}),y=(yyy2+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[12]<0) {sub$Q10[12]} else {0}, if (sub$Q10[12]<0) {sub$Q10[12]} else {0}, if (sub$Q90[12]<0) {sub$Q90[12]} else {0}, if (sub$Q90[12]<0) {sub$Q90[12]} else {0}),y=(yyy3+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[12]>0) {sub$Q2.5[12]} else {0}, if (sub$Q2.5[12]>0) {sub$Q2.5[12]} else {0}, if (sub$Q97.5[12]>0) {sub$Q97.5[12]} else {0}, if (sub$Q97.5[12]>0) {sub$Q97.5[12]} else {0}),y=(yyy1+3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[12]>0) {sub$Q5[12]} else {0}, if (sub$Q5[12]>0) {sub$Q5[12]} else {0}, if (sub$Q95[12]>0) {sub$Q95[12]} else {0}, if (sub$Q95[12]>0) {sub$Q95[12]} else {0}),y=(yyy2+3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[12]>0) {sub$Q10[12]} else {0}, if (sub$Q10[12]>0) {sub$Q10[12]} else {0}, if (sub$Q90[12]>0) {sub$Q90[12]} else {0}, if (sub$Q90[12]>0) {sub$Q90[12]} else {0}),y=(yyy3+3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[2]<0) {sub$Q2.5[2]} else {0}, if (sub$Q2.5[2]<0) {sub$Q2.5[2]} else {0}, if (sub$Q97.5[2]<0) {sub$Q97.5[2]} else {0}, if (sub$Q97.5[2]<0) {sub$Q97.5[2]} else {0}),y=(yyy1+4), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[2]<0) {sub$Q5[2]} else {0}, if (sub$Q5[2]<0) {sub$Q5[2]} else {0}, if (sub$Q95[2]<0) {sub$Q95[2]} else {0}, if (sub$Q95[2]<0) {sub$Q95[2]} else {0}),y=(yyy2+4), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[2]<0) {sub$Q10[2]} else {0}, if (sub$Q10[2]<0) {sub$Q10[2]} else {0}, if (sub$Q90[2]<0) {sub$Q90[2]} else {0}, if (sub$Q90[2]<0) {sub$Q90[2]} else {0}),y=(yyy3+4), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[2]>0) {sub$Q2.5[2]} else {0}, if (sub$Q2.5[2]>0) {sub$Q2.5[2]} else {0}, if (sub$Q97.5[2]>0) {sub$Q97.5[2]} else {0}, if (sub$Q97.5[2]>0) {sub$Q97.5[2]} else {0}),y=(yyy1+4), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[2]>0) {sub$Q5[2]} else {0}, if (sub$Q5[2]>0) {sub$Q5[2]} else {0}, if (sub$Q95[2]>0) {sub$Q95[2]} else {0}, if (sub$Q95[2]>0) {sub$Q95[2]} else {0}),y=(yyy2+4), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[2]>0) {sub$Q10[2]} else {0}, if (sub$Q10[2]>0) {sub$Q10[2]} else {0}, if (sub$Q90[2]>0) {sub$Q90[2]} else {0}, if (sub$Q90[2]>0) {sub$Q90[2]} else {0}),y=(yyy3+4), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[4]<0) {sub$Q2.5[4]} else {0}, if (sub$Q2.5[4]<0) {sub$Q2.5[4]} else {0}, if (sub$Q97.5[4]<0) {sub$Q97.5[4]} else {0}, if (sub$Q97.5[4]<0) {sub$Q97.5[4]} else {0}),y=(yyy1+5), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[4]<0) {sub$Q5[4]} else {0}, if (sub$Q5[4]<0) {sub$Q5[4]} else {0}, if (sub$Q95[4]<0) {sub$Q95[4]} else {0}, if (sub$Q95[4]<0) {sub$Q95[4]} else {0}),y=(yyy2+5), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[4]<0) {sub$Q10[4]} else {0}, if (sub$Q10[4]<0) {sub$Q10[4]} else {0}, if (sub$Q90[4]<0) {sub$Q90[4]} else {0}, if (sub$Q90[4]<0) {sub$Q90[4]} else {0}),y=(yyy3+5), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[4]>0) {sub$Q2.5[4]} else {0}, if (sub$Q2.5[4]>0) {sub$Q2.5[4]} else {0}, if (sub$Q97.5[4]>0) {sub$Q97.5[4]} else {0}, if (sub$Q97.5[4]>0) {sub$Q97.5[4]} else {0}),y=(yyy1+5), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[4]>0) {sub$Q5[4]} else {0}, if (sub$Q5[4]>0) {sub$Q5[4]} else {0}, if (sub$Q95[4]>0) {sub$Q95[4]} else {0}, if (sub$Q95[4]>0) {sub$Q95[4]} else {0}),y=(yyy2+5), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[4]>0) {sub$Q10[4]} else {0}, if (sub$Q10[4]>0) {sub$Q10[4]} else {0}, if (sub$Q90[4]>0) {sub$Q90[4]} else {0}, if (sub$Q90[4]>0) {sub$Q90[4]} else {0}),y=(yyy3+5), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[3]<0) {sub$Q2.5[3]} else {0}, if (sub$Q2.5[3]<0) {sub$Q2.5[3]} else {0}, if (sub$Q97.5[3]<0) {sub$Q97.5[3]} else {0}, if (sub$Q97.5[3]<0) {sub$Q97.5[3]} else {0}),y=(yyy1+6), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[3]<0) {sub$Q5[3]} else {0}, if (sub$Q5[3]<0) {sub$Q5[3]} else {0}, if (sub$Q95[3]<0) {sub$Q95[3]} else {0}, if (sub$Q95[3]<0) {sub$Q95[3]} else {0}),y=(yyy2+6), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[3]<0) {sub$Q10[3]} else {0}, if (sub$Q10[3]<0) {sub$Q10[3]} else {0}, if (sub$Q90[3]<0) {sub$Q90[3]} else {0}, if (sub$Q90[3]<0) {sub$Q90[3]} else {0}),y=(yyy3+6), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[3]>0) {sub$Q2.5[3]} else {0}, if (sub$Q2.5[3]>0) {sub$Q2.5[3]} else {0}, if (sub$Q97.5[3]>0) {sub$Q97.5[3]} else {0}, if (sub$Q97.5[3]>0) {sub$Q97.5[3]} else {0}),y=(yyy1+6), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[3]>0) {sub$Q5[3]} else {0}, if (sub$Q5[3]>0) {sub$Q5[3]} else {0}, if (sub$Q95[3]>0) {sub$Q95[3]} else {0}, if (sub$Q95[3]>0) {sub$Q95[3]} else {0}),y=(yyy2+6), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[3]>0) {sub$Q10[3]} else {0}, if (sub$Q10[3]>0) {sub$Q10[3]} else {0}, if (sub$Q90[3]>0) {sub$Q90[3]} else {0}, if (sub$Q90[3]>0) {sub$Q90[3]} else {0}),y=(yyy3+6), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[5]<0) {sub$Q2.5[5]} else {0}, if (sub$Q2.5[5]<0) {sub$Q2.5[5]} else {0}, if (sub$Q97.5[5]<0) {sub$Q97.5[5]} else {0}, if (sub$Q97.5[5]<0) {sub$Q97.5[5]} else {0}),y=(yyy1+7), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[5]<0) {sub$Q5[5]} else {0}, if (sub$Q5[5]<0) {sub$Q5[5]} else {0}, if (sub$Q95[5]<0) {sub$Q95[5]} else {0}, if (sub$Q95[5]<0) {sub$Q95[5]} else {0}),y=(yyy2+7), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[5]<0) {sub$Q10[5]} else {0}, if (sub$Q10[5]<0) {sub$Q10[5]} else {0}, if (sub$Q90[5]<0) {sub$Q90[5]} else {0}, if (sub$Q90[5]<0) {sub$Q90[5]} else {0}),y=(yyy3+7), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[5]>0) {sub$Q2.5[5]} else {0}, if (sub$Q2.5[5]>0) {sub$Q2.5[5]} else {0}, if (sub$Q97.5[5]>0) {sub$Q97.5[5]} else {0}, if (sub$Q97.5[5]>0) {sub$Q97.5[5]} else {0}),y=(yyy1+7), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[5]>0) {sub$Q5[5]} else {0}, if (sub$Q5[5]>0) {sub$Q5[5]} else {0}, if (sub$Q95[5]>0) {sub$Q95[5]} else {0}, if (sub$Q95[5]>0) {sub$Q95[5]} else {0}),y=(yyy2+7), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[5]>0) {sub$Q10[5]} else {0}, if (sub$Q10[5]>0) {sub$Q10[5]} else {0}, if (sub$Q90[5]>0) {sub$Q90[5]} else {0}, if (sub$Q90[5]>0) {sub$Q90[5]} else {0}),y=(yyy3+7), col = "dodgerblue", border = NA)
abline(h=3.5,lty=2, col="grey60")
abline(h=4.5,lty=2, col="grey60")

#### RaoQ #####
sub <- subset(drivEst, Response == "RaoQ")
est1 <- sub$Estimate[2:5]
est2 <- sub$Estimate[10:12]
est <- c(est1,est2)
plot(yy ~ est, ylab="",xlab="", yaxt="n", las=1, type="n",xlim=c(-0.05,0.07), ylim=c(1.7,9.4), cex=2, bty="n")
segments(x0=0,y0=0,x1=0,y1=8.4,lty=2, lwd=2,col="grey60")
title(xlab="Estimate", line=2.4,cex.lab=1.3)
legend("topleft", legend=("d) Rao's Q"), bty="n", cex=1.3)
mm <- cbind(yy,est)
mm_neg <- as.data.frame(mm[ which(est < 0),])
mm_pos <- as.data.frame(mm[ which(est > 0),])
#points(yy ~ est, pch="l",cex=2.2,col="white")
points(mm_neg$yy ~ mm_neg$est, pch="l",cex=2,col="firebrick2")
points(mm_pos$yy ~ mm_pos$est, pch="l",cex=2,col="dodgerblue")
yyy1=c(0.975,1.025,1.025,0.975)
yyy2=c(0.95,1.05,1.05,0.95)
yyy3=c(0.9,1.1,1.1,0.9)
polygon(x=c(if (sub$Q2.5[11]<0) {sub$Q2.5[11]} else {0}, if (sub$Q2.5[11]<0) {sub$Q2.5[11]} else {0}, if (sub$Q97.5[11]<0) {sub$Q97.5[11]} else {0}, if (sub$Q97.5[11]<0) {sub$Q97.5[11]} else {0}),y=(yyy1+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[11]<0) {sub$Q5[11]} else {0}, if (sub$Q5[11]<0) {sub$Q5[11]} else {0}, if (sub$Q95[11]<0) {sub$Q95[11]} else {0}, if (sub$Q95[11]<0) {sub$Q95[11]} else {0}),y=(yyy2+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[11]<0) {sub$Q10[11]} else {0}, if (sub$Q10[11]<0) {sub$Q10[11]} else {0}, if (sub$Q90[11]<0) {sub$Q90[11]} else {0}, if (sub$Q90[11]<0) {sub$Q90[11]} else {0}),y=(yyy3+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[11]>0) {sub$Q2.5[11]} else {0}, if (sub$Q2.5[11]>0) {sub$Q2.5[11]} else {0}, if (sub$Q97.5[11]>0) {sub$Q97.5[11]} else {0}, if (sub$Q97.5[11]>0) {sub$Q97.5[11]} else {0}),y=(yyy1+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[11]>0) {sub$Q5[11]} else {0}, if (sub$Q5[11]>0) {sub$Q5[11]} else {0}, if (sub$Q95[11]>0) {sub$Q95[11]} else {0}, if (sub$Q95[11]>0) {sub$Q95[11]} else {0}),y=(yyy2+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[11]>0) {sub$Q10[11]} else {0}, if (sub$Q10[11]>0) {sub$Q10[11]} else {0}, if (sub$Q90[11]>0) {sub$Q90[11]} else {0}, if (sub$Q90[11]>0) {sub$Q90[11]} else {0}),y=(yyy3+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[10]<0) {sub$Q2.5[10]} else {0}, if (sub$Q2.5[10]<0) {sub$Q2.5[10]} else {0}, if (sub$Q97.5[10]<0) {sub$Q97.5[10]} else {0}, if (sub$Q97.5[10]<0) {sub$Q97.5[10]} else {0}),y=(yyy1+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[10]<0) {sub$Q5[10]} else {0}, if (sub$Q5[10]<0) {sub$Q5[10]} else {0}, if (sub$Q95[10]<0) {sub$Q95[10]} else {0}, if (sub$Q95[10]<0) {sub$Q95[10]} else {0}),y=(yyy2+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[10]<0) {sub$Q10[10]} else {0}, if (sub$Q10[10]<0) {sub$Q10[10]} else {0}, if (sub$Q90[10]<0) {sub$Q90[10]} else {0}, if (sub$Q90[10]<0) {sub$Q90[10]} else {0}),y=(yyy3+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[10]>0) {sub$Q2.5[10]} else {0}, if (sub$Q2.5[10]>0) {sub$Q2.5[10]} else {0}, if (sub$Q97.5[10]>0) {sub$Q97.5[10]} else {0}, if (sub$Q97.5[10]>0) {sub$Q97.5[10]} else {0}),y=(yyy1+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[10]>0) {sub$Q5[10]} else {0}, if (sub$Q5[10]>0) {sub$Q5[10]} else {0}, if (sub$Q95[10]>0) {sub$Q95[10]} else {0}, if (sub$Q95[10]>0) {sub$Q95[10]} else {0}),y=(yyy2+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[10]>0) {sub$Q10[10]} else {0}, if (sub$Q10[10]>0) {sub$Q10[10]} else {0}, if (sub$Q90[10]>0) {sub$Q90[10]} else {0}, if (sub$Q90[10]>0) {sub$Q90[10]} else {0}),y=(yyy3+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[12]<0) {sub$Q2.5[12]} else {0}, if (sub$Q2.5[12]<0) {sub$Q2.5[12]} else {0}, if (sub$Q97.5[12]<0) {sub$Q97.5[12]} else {0}, if (sub$Q97.5[12]<0) {sub$Q97.5[12]} else {0}),y=(yyy1+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[12]<0) {sub$Q5[12]} else {0}, if (sub$Q5[12]<0) {sub$Q5[12]} else {0}, if (sub$Q95[12]<0) {sub$Q95[12]} else {0}, if (sub$Q95[12]<0) {sub$Q95[12]} else {0}),y=(yyy2+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[12]<0) {sub$Q10[12]} else {0}, if (sub$Q10[12]<0) {sub$Q10[12]} else {0}, if (sub$Q90[12]<0) {sub$Q90[12]} else {0}, if (sub$Q90[12]<0) {sub$Q90[12]} else {0}),y=(yyy3+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[12]>0) {sub$Q2.5[12]} else {0}, if (sub$Q2.5[12]>0) {sub$Q2.5[12]} else {0}, if (sub$Q97.5[12]>0) {sub$Q97.5[12]} else {0}, if (sub$Q97.5[12]>0) {sub$Q97.5[12]} else {0}),y=(yyy1+3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[12]>0) {sub$Q5[12]} else {0}, if (sub$Q5[12]>0) {sub$Q5[12]} else {0}, if (sub$Q95[12]>0) {sub$Q95[12]} else {0}, if (sub$Q95[12]>0) {sub$Q95[12]} else {0}),y=(yyy2+3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[12]>0) {sub$Q10[12]} else {0}, if (sub$Q10[12]>0) {sub$Q10[12]} else {0}, if (sub$Q90[12]>0) {sub$Q90[12]} else {0}, if (sub$Q90[12]>0) {sub$Q90[12]} else {0}),y=(yyy3+3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[2]<0) {sub$Q2.5[2]} else {0}, if (sub$Q2.5[2]<0) {sub$Q2.5[2]} else {0}, if (sub$Q97.5[2]<0) {sub$Q97.5[2]} else {0}, if (sub$Q97.5[2]<0) {sub$Q97.5[2]} else {0}),y=(yyy1+4), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[2]<0) {sub$Q5[2]} else {0}, if (sub$Q5[2]<0) {sub$Q5[2]} else {0}, if (sub$Q95[2]<0) {sub$Q95[2]} else {0}, if (sub$Q95[2]<0) {sub$Q95[2]} else {0}),y=(yyy2+4), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[2]<0) {sub$Q10[2]} else {0}, if (sub$Q10[2]<0) {sub$Q10[2]} else {0}, if (sub$Q90[2]<0) {sub$Q90[2]} else {0}, if (sub$Q90[2]<0) {sub$Q90[2]} else {0}),y=(yyy3+4), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[2]>0) {sub$Q2.5[2]} else {0}, if (sub$Q2.5[2]>0) {sub$Q2.5[2]} else {0}, if (sub$Q97.5[2]>0) {sub$Q97.5[2]} else {0}, if (sub$Q97.5[2]>0) {sub$Q97.5[2]} else {0}),y=(yyy1+4), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[2]>0) {sub$Q5[2]} else {0}, if (sub$Q5[2]>0) {sub$Q5[2]} else {0}, if (sub$Q95[2]>0) {sub$Q95[2]} else {0}, if (sub$Q95[2]>0) {sub$Q95[2]} else {0}),y=(yyy2+4), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[2]>0) {sub$Q10[2]} else {0}, if (sub$Q10[2]>0) {sub$Q10[2]} else {0}, if (sub$Q90[2]>0) {sub$Q90[2]} else {0}, if (sub$Q90[2]>0) {sub$Q90[2]} else {0}),y=(yyy3+4), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[4]<0) {sub$Q2.5[4]} else {0}, if (sub$Q2.5[4]<0) {sub$Q2.5[4]} else {0}, if (sub$Q97.5[4]<0) {sub$Q97.5[4]} else {0}, if (sub$Q97.5[4]<0) {sub$Q97.5[4]} else {0}),y=(yyy1+5), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[4]<0) {sub$Q5[4]} else {0}, if (sub$Q5[4]<0) {sub$Q5[4]} else {0}, if (sub$Q95[4]<0) {sub$Q95[4]} else {0}, if (sub$Q95[4]<0) {sub$Q95[4]} else {0}),y=(yyy2+5), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[4]<0) {sub$Q10[4]} else {0}, if (sub$Q10[4]<0) {sub$Q10[4]} else {0}, if (sub$Q90[4]<0) {sub$Q90[4]} else {0}, if (sub$Q90[4]<0) {sub$Q90[4]} else {0}),y=(yyy3+5), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[4]>0) {sub$Q2.5[4]} else {0}, if (sub$Q2.5[4]>0) {sub$Q2.5[4]} else {0}, if (sub$Q97.5[4]>0) {sub$Q97.5[4]} else {0}, if (sub$Q97.5[4]>0) {sub$Q97.5[4]} else {0}),y=(yyy1+5), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[4]>0) {sub$Q5[4]} else {0}, if (sub$Q5[4]>0) {sub$Q5[4]} else {0}, if (sub$Q95[4]>0) {sub$Q95[4]} else {0}, if (sub$Q95[4]>0) {sub$Q95[4]} else {0}),y=(yyy2+5), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[4]>0) {sub$Q10[4]} else {0}, if (sub$Q10[4]>0) {sub$Q10[4]} else {0}, if (sub$Q90[4]>0) {sub$Q90[4]} else {0}, if (sub$Q90[4]>0) {sub$Q90[4]} else {0}),y=(yyy3+5), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[3]<0) {sub$Q2.5[3]} else {0}, if (sub$Q2.5[3]<0) {sub$Q2.5[3]} else {0}, if (sub$Q97.5[3]<0) {sub$Q97.5[3]} else {0}, if (sub$Q97.5[3]<0) {sub$Q97.5[3]} else {0}),y=(yyy1+6), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[3]<0) {sub$Q5[3]} else {0}, if (sub$Q5[3]<0) {sub$Q5[3]} else {0}, if (sub$Q95[3]<0) {sub$Q95[3]} else {0}, if (sub$Q95[3]<0) {sub$Q95[3]} else {0}),y=(yyy2+6), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[3]<0) {sub$Q10[3]} else {0}, if (sub$Q10[3]<0) {sub$Q10[3]} else {0}, if (sub$Q90[3]<0) {sub$Q90[3]} else {0}, if (sub$Q90[3]<0) {sub$Q90[3]} else {0}),y=(yyy3+6), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[3]>0) {sub$Q2.5[3]} else {0}, if (sub$Q2.5[3]>0) {sub$Q2.5[3]} else {0}, if (sub$Q97.5[3]>0) {sub$Q97.5[3]} else {0}, if (sub$Q97.5[3]>0) {sub$Q97.5[3]} else {0}),y=(yyy1+6), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[3]>0) {sub$Q5[3]} else {0}, if (sub$Q5[3]>0) {sub$Q5[3]} else {0}, if (sub$Q95[3]>0) {sub$Q95[3]} else {0}, if (sub$Q95[3]>0) {sub$Q95[3]} else {0}),y=(yyy2+6), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[3]>0) {sub$Q10[3]} else {0}, if (sub$Q10[3]>0) {sub$Q10[3]} else {0}, if (sub$Q90[3]>0) {sub$Q90[3]} else {0}, if (sub$Q90[3]>0) {sub$Q90[3]} else {0}),y=(yyy3+6), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q2.5[5]<0) {sub$Q2.5[5]} else {0}, if (sub$Q2.5[5]<0) {sub$Q2.5[5]} else {0}, if (sub$Q97.5[5]<0) {sub$Q97.5[5]} else {0}, if (sub$Q97.5[5]<0) {sub$Q97.5[5]} else {0}),y=(yyy1+7), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[5]<0) {sub$Q5[5]} else {0}, if (sub$Q5[5]<0) {sub$Q5[5]} else {0}, if (sub$Q95[5]<0) {sub$Q95[5]} else {0}, if (sub$Q95[5]<0) {sub$Q95[5]} else {0}),y=(yyy2+7), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[5]<0) {sub$Q10[5]} else {0}, if (sub$Q10[5]<0) {sub$Q10[5]} else {0}, if (sub$Q90[5]<0) {sub$Q90[5]} else {0}, if (sub$Q90[5]<0) {sub$Q90[5]} else {0}),y=(yyy3+7), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q2.5[5]>0) {sub$Q2.5[5]} else {0}, if (sub$Q2.5[5]>0) {sub$Q2.5[5]} else {0}, if (sub$Q97.5[5]>0) {sub$Q97.5[5]} else {0}, if (sub$Q97.5[5]>0) {sub$Q97.5[5]} else {0}),y=(yyy1+7), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[5]>0) {sub$Q5[5]} else {0}, if (sub$Q5[5]>0) {sub$Q5[5]} else {0}, if (sub$Q95[5]>0) {sub$Q95[5]} else {0}, if (sub$Q95[5]>0) {sub$Q95[5]} else {0}),y=(yyy2+7), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[5]>0) {sub$Q10[5]} else {0}, if (sub$Q10[5]>0) {sub$Q10[5]} else {0}, if (sub$Q90[5]>0) {sub$Q90[5]} else {0}, if (sub$Q90[5]>0) {sub$Q90[5]} else {0}),y=(yyy3+7), col = "dodgerblue", border = NA)
abline(h=3.5,lty=2, col="grey60")
abline(h=4.5,lty=2, col="grey60")

##
dev.off()
##

